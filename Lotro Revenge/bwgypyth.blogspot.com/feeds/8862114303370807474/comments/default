<?xml version='1.0' encoding='UTF-8'?><?xml-stylesheet href="http://www.blogger.com/styles/atom.css" type="text/css"?><feed xmlns='http://www.w3.org/2005/Atom' xmlns:openSearch='http://a9.com/-/spec/opensearchrss/1.0/' xmlns:gd="http://schemas.google.com/g/2005"><id>tag:blogger.com,1999:blog-5998090735925918818.post8862114303370807474..comments</id><updated>2020-10-08T13:30:29.666-07:00</updated><title type='text'>Comments on lotro revenge: Regarding compressed communication</title><link rel='http://schemas.google.com/g/2005#feed' type='application/atom+xml' href='http://bwgypyth.blogspot.com/feeds/comments/default'/><link rel='self' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default'/><link rel='alternate' type='text/html' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html'/><link rel="hub" href="http://pubsubhubbub.appspot.com/"/><author><name>bwgypyth</name><uri>http://www.blogger.com/profile/05117736107025149323</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='16' height='16' src='https://img1.blogblog.com/img/b16-rounded.gif'/></author><generator version='7.00' uri='http://www.blogger.com'>Blogger</generator><openSearch:totalResults>14</openSearch:totalResults><openSearch:startIndex>1</openSearch:startIndex><openSearch:itemsPerPage>25</openSearch:itemsPerPage><entry><id>tag:blogger.com,1999:blog-5998090735925918818.post-1935218509438603139</id><published>2012-03-24T07:41:44.771-07:00</published><updated>2012-03-24T07:41:44.771-07:00</updated><title type='text'>Here it is:&#xa;&#xa;Class to (re)encrypt server and clien...</title><content type='html'>Here it is:&lt;br /&gt;&lt;br /&gt;Class to (re)encrypt server and client packets again, plus a updated helper class for calculating the checksum of the data block of a packet. The head checksum generation(remember: mix of packet sequence nr look up in a table plus the 4 bytes at the right side of checksum) isn&amp;#39;t working correctly til now. further invests are needed. &lt;br /&gt;&lt;br /&gt;http://www.2shared.com/file/7CVQl7GY/LOTROS2012.html&lt;br /&gt;&lt;br /&gt;-T-</content><link rel='edit' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/1935218509438603139'/><link rel='self' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/1935218509438603139'/><link rel='alternate' type='text/html' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html?showComment=1332600104771#c1935218509438603139' title=''/><author><name>tAmMo</name><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='16' height='16' src='https://img1.blogblog.com/img/blank.gif'/></author><thr:in-reply-to xmlns:thr='http://purl.org/syndication/thread/1.0' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html' ref='tag:blogger.com,1999:blog-5998090735925918818.post-8862114303370807474' source='http://www.blogger.com/feeds/5998090735925918818/posts/default/8862114303370807474' type='text/html'/><gd:extendedProperty name="blogger.itemClass" value="pid-380951758"/><gd:extendedProperty name="blogger.displayTime" value="24. März 2012 um 07:41"/></entry><entry><id>tag:blogger.com,1999:blog-5998090735925918818.post-8660801863683921899</id><published>2012-03-20T16:11:45.235-07:00</published><updated>2012-03-20T16:11:45.235-07:00</updated><title type='text'>I&amp;#39;d be happy to get my hands on the encryption...</title><content type='html'>I&amp;#39;d be happy to get my hands on the encryption code. I currently don&amp;#39;t have much time myself but if you upload the code (or send it to me) I&amp;#39;ll put it into the gitorious repository.&lt;br /&gt;&lt;br /&gt;Keep up the great work!</content><link rel='edit' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/8660801863683921899'/><link rel='self' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/8660801863683921899'/><link rel='alternate' type='text/html' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html?showComment=1332285105235#c8660801863683921899' title=''/><author><name>bwgypyth</name><uri>https://www.blogger.com/profile/05117736107025149323</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='16' height='16' src='https://img1.blogblog.com/img/b16-rounded.gif'/></author><thr:in-reply-to xmlns:thr='http://purl.org/syndication/thread/1.0' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html' ref='tag:blogger.com,1999:blog-5998090735925918818.post-8862114303370807474' source='http://www.blogger.com/feeds/5998090735925918818/posts/default/8862114303370807474' type='text/html'/><gd:extendedProperty name="blogger.itemClass" value="pid-957954180"/><gd:extendedProperty name="blogger.displayTime" value="20. März 2012 um 16:11"/></entry><entry><id>tag:blogger.com,1999:blog-5998090735925918818.post-8181627460292485582</id><published>2012-03-18T13:15:07.574-07:00</published><updated>2012-03-18T13:15:07.574-07:00</updated><title type='text'>sorry my mistake i changed two bytes... look for 0...</title><content type='html'>sorry my mistake i changed two bytes... look for 00 00 00 8B 4D 0C 3B C1 75 2D inside the newest version of lotro.exe. You should find it only once. Change 75 2D to 90 90 so that the check is removed and every packet header chksum is handled as valid. then you can change your character name without problems. don&amp;#39;t forget to change the beginning length and data block length. i don&amp;#39;t know where to find values like character level, hp, vip status, ...&lt;br /&gt;&lt;br /&gt;at the moment i haven&amp;#39;t got much time. Last time i wanted to write a more generic server(with fake values), so that you don&amp;#39;t have to log packets and use them to find things out. This piece of work must wait. sorry. But I can upload the encryption routine and the not final checksum validation for head checksum if you are interested.&lt;br /&gt;&lt;br /&gt;-T-</content><link rel='edit' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/8181627460292485582'/><link rel='self' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/8181627460292485582'/><link rel='alternate' type='text/html' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html?showComment=1332101707574#c8181627460292485582' title=''/><author><name>Anonymous</name><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='16' height='16' src='https://img1.blogblog.com/img/blank.gif'/></author><thr:in-reply-to xmlns:thr='http://purl.org/syndication/thread/1.0' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html' ref='tag:blogger.com,1999:blog-5998090735925918818.post-8862114303370807474' source='http://www.blogger.com/feeds/5998090735925918818/posts/default/8862114303370807474' type='text/html'/><gd:extendedProperty name="blogger.itemClass" value="pid-380951758"/><gd:extendedProperty name="blogger.displayTime" value="18. März 2012 um 13:15"/></entry><entry><id>tag:blogger.com,1999:blog-5998090735925918818.post-2068162042098052680</id><published>2012-03-15T23:07:58.680-07:00</published><updated>2012-03-15T23:07:58.680-07:00</updated><title type='text'>Grats. Lookup tables were what xbadc0de used in th...</title><content type='html'>Grats. Lookup tables were what xbadc0de used in the end.&lt;br /&gt;&lt;br /&gt;Does the exe patch need to be permanent, or we can step around it with an injected JMP after the client is started?</content><link rel='edit' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/2068162042098052680'/><link rel='self' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/2068162042098052680'/><link rel='alternate' type='text/html' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html?showComment=1331878078680#c2068162042098052680' title=''/><author><name>JCairn</name><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='16' height='16' src='https://img1.blogblog.com/img/blank.gif'/></author><thr:in-reply-to xmlns:thr='http://purl.org/syndication/thread/1.0' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html' ref='tag:blogger.com,1999:blog-5998090735925918818.post-8862114303370807474' source='http://www.blogger.com/feeds/5998090735925918818/posts/default/8862114303370807474' type='text/html'/><gd:extendedProperty name="blogger.itemClass" value="pid-380951758"/><gd:extendedProperty name="blogger.displayTime" value="15. März 2012 um 23:07"/></entry><entry><id>tag:blogger.com,1999:blog-5998090735925918818.post-2658409634467911306</id><published>2012-03-15T14:34:32.682-07:00</published><updated>2012-03-15T14:34:32.682-07:00</updated><title type='text'>Hi,&#xa;&#xa;solved the checksum problem. it was really di...</title><content type='html'>Hi,&lt;br /&gt;&lt;br /&gt;solved the checksum problem. it was really dirty. also with lookup tables. it&amp;#39;s depending on the packet number, the length of the &amp;quot;head&amp;quot;, one static value and some summing. the next big problem: i fear that every entry in the datablock is also checksummed. somehow it looks like that. this is why they look so strange...!&lt;br /&gt;&lt;br /&gt;the easiest workaround, you only have to patch one byte in .exe and checksum protection is snow from yesterday. this saves a lot of work where you can make mistakes. you can inject everything (change chara names, change the join world server to yours ...)&lt;br /&gt;&lt;br /&gt;btw. encryption is working for 100%. there was a little mistake at my side, but now it&amp;#39;s corrected and does like it should do. encryption routines will be &amp;quot;released&amp;quot; soon. if someone wants to make a ps this won&amp;#39;t be a obstacle.&lt;br /&gt;&lt;br /&gt;summery what can be done til now:&lt;br /&gt;&lt;br /&gt;a.) get the correct checksum for whole data block in packet(the size is given in the beginning)&lt;br /&gt;b.) generate checksum for head (the first 20 bytes in packet, the checksum is 2 parted: 4 bytes vary, next 2 increase, last 2 bytes stay the whole time)&lt;br /&gt;c.) encrypt+decrypt client and server packets.&lt;br /&gt;&lt;br /&gt;Greeting&lt;br /&gt;&lt;br /&gt;-T-</content><link rel='edit' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/2658409634467911306'/><link rel='self' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/2658409634467911306'/><link rel='alternate' type='text/html' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html?showComment=1331847272682#c2658409634467911306' title=''/><author><name>Anonymous</name><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='16' height='16' src='https://img1.blogblog.com/img/blank.gif'/></author><thr:in-reply-to xmlns:thr='http://purl.org/syndication/thread/1.0' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html' ref='tag:blogger.com,1999:blog-5998090735925918818.post-8862114303370807474' source='http://www.blogger.com/feeds/5998090735925918818/posts/default/8862114303370807474' type='text/html'/><gd:extendedProperty name="blogger.itemClass" value="pid-380951758"/><gd:extendedProperty name="blogger.displayTime" value="15. März 2012 um 14:34"/></entry><entry><id>tag:blogger.com,1999:blog-5998090735925918818.post-2423896334039661573</id><published>2012-03-15T12:53:36.558-07:00</published><updated>2012-03-15T12:53:36.558-07:00</updated><title type='text'>This is a great piece of work.&#xa;&#xa;I remember the che...</title><content type='html'>This is a great piece of work.&lt;br /&gt;&lt;br /&gt;I remember the checksums gave xbadc0de a lot of problems. I don&amp;#39;t think we ever solved how they were being generated.</content><link rel='edit' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/2423896334039661573'/><link rel='self' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/2423896334039661573'/><link rel='alternate' type='text/html' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html?showComment=1331841216558#c2423896334039661573' title=''/><author><name>JCairn</name><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='16' height='16' src='https://img1.blogblog.com/img/blank.gif'/></author><thr:in-reply-to xmlns:thr='http://purl.org/syndication/thread/1.0' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html' ref='tag:blogger.com,1999:blog-5998090735925918818.post-8862114303370807474' source='http://www.blogger.com/feeds/5998090735925918818/posts/default/8862114303370807474' type='text/html'/><gd:extendedProperty name="blogger.itemClass" value="pid-380951758"/><gd:extendedProperty name="blogger.displayTime" value="15. März 2012 um 12:53"/></entry><entry><id>tag:blogger.com,1999:blog-5998090735925918818.post-6735513435044405504</id><published>2012-03-08T17:31:34.863-08:00</published><updated>2012-03-08T17:31:34.863-08:00</updated><title type='text'>sorry had to delete it, because i left some privat...</title><content type='html'>sorry had to delete it, because i left some private data ;-)&lt;br /&gt;&lt;br /&gt;here again:&lt;br /&gt;&lt;br /&gt;http://www.2shared.com/file/PqsfbdiW/LOTRO-Tools.html&lt;br /&gt;&lt;br /&gt;same pw.&lt;br /&gt;&lt;br /&gt;md5: 92e242dd263cda3908b0f05b70ea130f&lt;br /&gt;sha-1: e9d6ba691495d180e430e8489af92e782f7a0874</content><link rel='edit' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/6735513435044405504'/><link rel='self' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/6735513435044405504'/><link rel='alternate' type='text/html' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html?showComment=1331256694863#c6735513435044405504' title=''/><author><name>Anonymous</name><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='16' height='16' src='https://img1.blogblog.com/img/blank.gif'/></author><thr:in-reply-to xmlns:thr='http://purl.org/syndication/thread/1.0' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html' ref='tag:blogger.com,1999:blog-5998090735925918818.post-8862114303370807474' source='http://www.blogger.com/feeds/5998090735925918818/posts/default/8862114303370807474' type='text/html'/><gd:extendedProperty name="blogger.itemClass" value="pid-380951758"/><gd:extendedProperty name="blogger.displayTime" value="8. März 2012 um 17:31"/></entry><entry><id>tag:blogger.com,1999:blog-5998090735925918818.post-5623691216074139997</id><published>2012-03-08T15:39:23.603-08:00</published><updated>2012-03-08T15:39:23.603-08:00</updated><title type='text'>Sorry, took a little bit longer to put it all toge...</title><content type='html'>Sorry, took a little bit longer to put it all together.&lt;br /&gt;&lt;br /&gt;I got good news for you: you can also decrypt client packets as well now!&lt;br /&gt;&lt;br /&gt;The reason why it took so long is, that i tried to (re)encrypt the packets too. And i got it working. But... There seems to be some checksum, so that a packet with modded values can&amp;#39;t be &amp;quot;injected&amp;quot;. Or i&amp;#39;ve looked over something important. The bevore decrypted packets look like the encrypted after running through the algo.&lt;br /&gt;&lt;br /&gt;I tought long time if i should release the encryption source too, but i didn&amp;#39;t this time. I fear that this could get into the wrong hands and people are trying to make cash with private servers. If you seriously need it and have good intentions then i will release it too.&lt;br /&gt;&lt;br /&gt;I also put an doc inside the zip of collected infos of some packets. Feel free to add something and re-release it so that we got one source for information. Btw. if you push the join world button, the client connects to an other server. This packet i tried to mod, so that i could connect afterwards to my server.&lt;br /&gt;&lt;br /&gt;If you got questions, i will answer it here.&lt;br /&gt;&lt;br /&gt;http://www.2shared.com/file/TKOhRKOk/LOTRO-Tools.html&lt;br /&gt;&lt;br /&gt;pw: bwgypyth.blogspot.com&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;The easiest way to decrypt is to run the &amp;quot;.net packet logger&amp;quot; inside the zip while you play the game. Look at the source its not to hard to understand. The creators write that this lib also works under mono. When i will set up ubuntu again, i will try to port it.&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Greets&lt;br /&gt;&lt;br /&gt;-T-</content><link rel='edit' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/5623691216074139997'/><link rel='self' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/5623691216074139997'/><link rel='alternate' type='text/html' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html?showComment=1331249963603#c5623691216074139997' title=''/><author><name>tAmMo</name><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='16' height='16' src='https://img1.blogblog.com/img/blank.gif'/></author><thr:in-reply-to xmlns:thr='http://purl.org/syndication/thread/1.0' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html' ref='tag:blogger.com,1999:blog-5998090735925918818.post-8862114303370807474' source='http://www.blogger.com/feeds/5998090735925918818/posts/default/8862114303370807474' type='text/html'/><gd:extendedProperty name="blogger.itemClass" value="pid-380951758"/><gd:extendedProperty name="blogger.displayTime" value="8. März 2012 um 15:39"/></entry><entry><id>tag:blogger.com,1999:blog-5998090735925918818.post-1676555866968823505</id><published>2012-02-25T03:56:40.576-08:00</published><updated>2012-02-25T03:56:40.576-08:00</updated><title type='text'>Congrats, that&amp;#39;s great news! I wish I had more...</title><content type='html'>Congrats, that&amp;#39;s great news! I wish I had more time to work on this at the moment :(&lt;br /&gt;&lt;br /&gt;From what I remember (this might be out of date now), the first two bytes of all the received packets are always the same, and are set up in the first received packet.&lt;br /&gt;&lt;br /&gt;The first two bytes of all sent packets are also always the same, and these are set up in the first received packet as well.</content><link rel='edit' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/1676555866968823505'/><link rel='self' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/1676555866968823505'/><link rel='alternate' type='text/html' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html?showComment=1330171000576#c1676555866968823505' title=''/><author><name>JCairn</name><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='16' height='16' src='https://img1.blogblog.com/img/blank.gif'/></author><thr:in-reply-to xmlns:thr='http://purl.org/syndication/thread/1.0' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html' ref='tag:blogger.com,1999:blog-5998090735925918818.post-8862114303370807474' source='http://www.blogger.com/feeds/5998090735925918818/posts/default/8862114303370807474' type='text/html'/><gd:extendedProperty name="blogger.itemClass" value="pid-380951758"/><gd:extendedProperty name="blogger.displayTime" value="25. Februar 2012 um 03:56"/></entry><entry><id>tag:blogger.com,1999:blog-5998090735925918818.post-6000266587203772520</id><published>2012-02-24T08:33:35.002-08:00</published><updated>2012-02-24T08:33:35.002-08:00</updated><title type='text'>Hello,&#xa;&#xa;i finally made it to decrypt the most of t...</title><content type='html'>Hello,&lt;br /&gt;&lt;br /&gt;i finally made it to decrypt the most of the server packets i collected during a session. Two bytes at the beginning of each packet are unclear to me, but i think i will figure this also out. At the moment i&amp;#39;m writing a little prog which automates this procedure. I will take a look if it could be used to encrypt own generated packets as well.&lt;br /&gt;&lt;br /&gt;Some things i can say clear:&lt;br /&gt;1. The CryptoApi isn&amp;#39;t involved. (Maybe through a workaround? I searched google for similar methods but found nothing)&lt;br /&gt;2. Charactername, Servername eg. Maiar[DE], IP, Loginname are inside this packets. There are 2 urls inside.&lt;br /&gt;&lt;br /&gt;The URL&amp;#39;s are as one string, the other vars are as Unicode formated(bigendian), with the length of the string given at first byte. The character values seem to have their own format, can&amp;#39;t say anything yet, because i haven&amp;#39;t tryed to (re)encrypt and feed the client.&lt;br /&gt;&lt;br /&gt;When this part is done i will post a link for a download location. &amp;#39;Til a fully working server could be written there will be a lot of more things to figure out.&lt;br /&gt;&lt;br /&gt;The code is written in C# and will work only on win, but if i understand mono correct this could easy be ported, because i use no win gui or special methods.&lt;br /&gt;&lt;br /&gt;Greetings&lt;br /&gt;&lt;br /&gt;-T-</content><link rel='edit' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/6000266587203772520'/><link rel='self' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/6000266587203772520'/><link rel='alternate' type='text/html' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html?showComment=1330101215002#c6000266587203772520' title=''/><author><name>tAmMo</name><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='16' height='16' src='https://img1.blogblog.com/img/blank.gif'/></author><thr:in-reply-to xmlns:thr='http://purl.org/syndication/thread/1.0' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html' ref='tag:blogger.com,1999:blog-5998090735925918818.post-8862114303370807474' source='http://www.blogger.com/feeds/5998090735925918818/posts/default/8862114303370807474' type='text/html'/><gd:extendedProperty name="blogger.itemClass" value="pid-380951758"/><gd:extendedProperty name="blogger.displayTime" value="24. Februar 2012 um 08:33"/></entry><entry><id>tag:blogger.com,1999:blog-5998090735925918818.post-6814641832888630069</id><published>2012-01-10T22:40:38.232-08:00</published><updated>2012-01-10T22:40:38.232-08:00</updated><title type='text'>It has changed. The login packets are now encrypte...</title><content type='html'>It has changed. The login packets are now encrypted as well. But let&amp;#39;s talk further in IRC.</content><link rel='edit' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/6814641832888630069'/><link rel='self' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/6814641832888630069'/><link rel='alternate' type='text/html' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html?showComment=1326264038232#c6814641832888630069' title=''/><author><name>The Austrian</name><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='16' height='16' src='https://img1.blogblog.com/img/blank.gif'/></author><thr:in-reply-to xmlns:thr='http://purl.org/syndication/thread/1.0' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html' ref='tag:blogger.com,1999:blog-5998090735925918818.post-8862114303370807474' source='http://www.blogger.com/feeds/5998090735925918818/posts/default/8862114303370807474' type='text/html'/><gd:extendedProperty name="blogger.itemClass" value="pid-380951758"/><gd:extendedProperty name="blogger.displayTime" value="10. Januar 2012 um 22:40"/></entry><entry><id>tag:blogger.com,1999:blog-5998090735925918818.post-1849938869779986629</id><published>2012-01-10T13:28:09.938-08:00</published><updated>2012-01-10T13:28:09.938-08:00</updated><title type='text'>From what I remember of the various packet dumps f...</title><content type='html'>From what I remember of the various packet dumps from LOTRO we had, characters names were transmitted in plaintext during login. That might have been changed though.&lt;br /&gt;&lt;br /&gt;I was wondering if it was possible that the client copied the RC4 decrypt function out of the crypto library so that it was impossible to hook calls to it after it is accessed the first time.&lt;br /&gt;&lt;br /&gt;When I remember, I&amp;#39;m on IRC: irc.efnet.net #lotroemu</content><link rel='edit' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/1849938869779986629'/><link rel='self' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/1849938869779986629'/><link rel='alternate' type='text/html' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html?showComment=1326230889938#c1849938869779986629' title=''/><author><name>JCairn</name><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='16' height='16' src='https://img1.blogblog.com/img/blank.gif'/></author><thr:in-reply-to xmlns:thr='http://purl.org/syndication/thread/1.0' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html' ref='tag:blogger.com,1999:blog-5998090735925918818.post-8862114303370807474' source='http://www.blogger.com/feeds/5998090735925918818/posts/default/8862114303370807474' type='text/html'/><gd:extendedProperty name="blogger.itemClass" value="pid-380951758"/><gd:extendedProperty name="blogger.displayTime" value="10. Januar 2012 um 13:28"/></entry><entry><id>tag:blogger.com,1999:blog-5998090735925918818.post-7739944597326901888</id><published>2012-01-08T23:55:03.413-08:00</published><updated>2012-01-08T23:55:03.413-08:00</updated><title type='text'>The compress calls are actually well explainable: ...</title><content type='html'>The compress calls are actually well explainable: PNG. DDO links to it (and I am almost certain LOTRO does too) and it requires zlib1, so alas, both games call it everytime they load a PNG. Do you have IM or IRC, so we perhaps can talk about those very similar games?</content><link rel='edit' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/7739944597326901888'/><link rel='self' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/7739944597326901888'/><link rel='alternate' type='text/html' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html?showComment=1326095703413#c7739944597326901888' title=''/><author><name>The Austrian</name><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='16' height='16' src='https://img1.blogblog.com/img/blank.gif'/></author><thr:in-reply-to xmlns:thr='http://purl.org/syndication/thread/1.0' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html' ref='tag:blogger.com,1999:blog-5998090735925918818.post-8862114303370807474' source='http://www.blogger.com/feeds/5998090735925918818/posts/default/8862114303370807474' type='text/html'/><gd:extendedProperty name="blogger.itemClass" value="pid-380951758"/><gd:extendedProperty name="blogger.displayTime" value="8. Januar 2012 um 23:55"/></entry><entry><id>tag:blogger.com,1999:blog-5998090735925918818.post-7893411016894272316</id><published>2012-01-08T04:48:14.858-08:00</published><updated>2012-01-08T04:48:14.858-08:00</updated><title type='text'>DDO is not using CryptEncrypt() any more after the...</title><content type='html'>DDO is not using CryptEncrypt() any more after the first welcome packet has been encrypted with the public key of the server. So if the stream really is encrypted with RC4, it has to use the RC4 key in its own RC4 implementation. What benefit that brings over using the already initialized RC4 from Windows eludes me. Or DDO is simply using some kind of library for RSA, that automatically generates a RC4 key just in case the user of the library decides he wants to use an RC4 cipher key.&lt;br /&gt;&lt;br /&gt;Even if you are applying the RC4 key, you extract from DDO to decrypt the packets, you have little way to verify that what you decrypt is actually the plain text. Although there must be some human understandable plain text around: Character Names. Since it&amp;#39;s reasonable to assume that character names are sent from the server to the client they *must* be in the packets, and the decryption can be verified once you find them in your plain text. Finding the character data is actually quite simple: The huge packets at the beginning when the client says &amp;quot;receiving character data&amp;quot;.&lt;br /&gt;&lt;br /&gt;But simply decrypting, or putting the data together (into one huge packet) doesn&amp;#39;t seem to do the trick. Unless I missed something important.</content><link rel='edit' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/7893411016894272316'/><link rel='self' type='application/atom+xml' href='http://www.blogger.com/feeds/5998090735925918818/8862114303370807474/comments/default/7893411016894272316'/><link rel='alternate' type='text/html' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html?showComment=1326026894858#c7893411016894272316' title=''/><author><name>The Austrian</name><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='16' height='16' src='https://img1.blogblog.com/img/blank.gif'/></author><thr:in-reply-to xmlns:thr='http://purl.org/syndication/thread/1.0' href='http://bwgypyth.blogspot.com/2011/12/regarding-compressed-communication.html' ref='tag:blogger.com,1999:blog-5998090735925918818.post-8862114303370807474' source='http://www.blogger.com/feeds/5998090735925918818/posts/default/8862114303370807474' type='text/html'/><gd:extendedProperty name="blogger.itemClass" value="pid-380951758"/><gd:extendedProperty name="blogger.displayTime" value="8. Januar 2012 um 04:48"/></entry></feed>